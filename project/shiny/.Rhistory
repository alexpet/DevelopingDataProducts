try(download.file(url = urlFile, destfile = destFile))
if (file.info(destFile)$size >
0) {
unlink(destFile)
return(-1)
}
} else {
return(0)
}
}
dr <- download.file('ftp://ftp.ncdc.noaa.gov/pub/data/noaa/2012/716240-99999-2011.gz', 'data/raw/716240-99999-2011.gz')
dr
try(download.file(url = urlFile, destfile = destFile))
?tryCatch
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
finally = unlink(destFile))
}
} else {
return(0)
}
}
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
finally = unlink(destFile))
}
} else {
return(0)
}
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
finally = unlink(destFile))
)}
} else {
return(0)
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
finally = unlink(destFile))
)
} else {
return(0)
}
}
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
finally = unlink(destFile))
} else {
return(0)
}
}
try(download.file(url = urlFile, destfile = destFile))
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
warning = return(0),
error = return(-1),
finally = unlink(destFile))
} else {
return(0)
}
}
r <- getWeather(di, s, e)
r
r <- getWeather(di, s, e)
r
weatherDownload("276120-99999-2013.gz", 2013)
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
warning = return(-1),
error = return(-1),
finally = unlink(destFile))
} else {
return(0)
}
}
weatherDownload("276120-99999-2013.gz", 2013)
weatherDownload("276120-99999-2013.gz", 2014)
weatherDownload("276120-99999-2013.gz", 2015)
dlF <- "276120-99999-2013.gz"
destFile <- paste("data/raw/", dlF, sep = "")
urlFiles
urlFile\
urlFile
destFile <- paste("data/raw/", 716240-99999-2012.gz, sep = "")
destFile <- paste("data/raw/", "716240-99999-2012.gz", sep = "")
urlFile
destFile
urlFile <- "ftp://ftp.ncdc.noaa.gov/pub/data/noaa/2012/716240-99999-2012.gz"
dr <- weatherDownload("276120-99999-2013.gz", 2013)
dr
urlFile
destFile
!file.exists(destFile)
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
warning = return(-1),
error = return(-1),
finally = unlink(destFile))
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
warning = function() {return(-1)},
error = function() {return(-1)},
finally = unlink(destFile))
} else {
return(0)
}
}
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
warning = function() {return(-1)},
error = function() {return(-1)},
finally = unlink(destFile))
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
warning = function() {return(-1)},
finally = unlink(destFile))
download.file(url = urlFile, destfile = destFile)
tryCatch(download.file(url = urlFile, destfile = destFile))
tryCatch(download.file(url = urlFile, destfile = destFile), warning = function{return(-1)})
tryCatch(download.file(url = urlFile, destfile = destFile), warning = function(){return(-1)})
tryCatch(download.file(url = urlFile, destfile = destFile), error = function(){return(-1)})
tryCatch(download.file(url = urlFile, destfile = destFile), error = function(e){return(e)})
tryCatch(download.file(url = urlFile, destfile = destFile), warning = function(e){return(e)}, error = function(e){return(e)})
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
},
warning = function(e) {return(e)},
error = function(e) {return(e)},
finally = unlink(destFile))
} else {
return("<file already downloaded>")
}
}
dr <- weatherDownload("276120-99999-2013.gz", 2013)
dr
dr <- weatherDownload("276120-99999-2013.gz", 2013)
dr
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat(destFile, sep="")
},
warning = function(e) {return(e)},
error = function(e) {return(e)},
finally = unlink(destFile))
} else {
return("<file already downloaded>")
}
}
dr <- weatherDownload("276120-99999-2013.gz", 2013)
dir("data/raw")
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {return(e)},
finally = unlink(destFile))
} else {
return("<file already downloaded>")
}
}
dir("data/raw")
dr <- weatherDownload("276120-99999-2013.gz", 2013)
dr
dr <- weatherDownload("276120-99999-2014.gz", 2014)
dir("data/raw/")
download.file("ftp://ftp.ncdc.noaa.gov/pub/data/noaa/2014/276120-99999-2014.gz","data/raw/276120-99999-2014.gz")
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {return(e)},
finally = unlink(destFile))
urlFile <- "ftp://ftp.ncdc.noaa.gov/pub/data/noaa/2014/276120-99999-2014.gz"
destFile <- "data/raw/276120-99999-2014.gz"
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {return(e)},
finally = unlink(destFile))
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {return(e)},
finally = unlink(destFile))
download.file(url = urlFile, destfile = destFile)
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {return(e)},
finally = unlink(destFile))
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {unlink(destFile)
return(e)})
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {unlink(destFile)
return(e)})
} else {
return("<file already downloaded>")
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {unlink(destFile)
return(e)})
} else {
return("<file already downloaded>")
}
}
dr <- weatherDownload("276120-99999-2014.gz", 2014)
dr <- weatherDownload("276120-99999-2013.gz", 2013)
dr
dr <- weatherDownload("276120-99999-2013.gz", 2013)
dr
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
},
warning = function(e) {return(e)},
error = function(e) {unlink(destFile)
return(e)},
finally = function() {return("<download successful>")})
} else {
return("<file already downloaded>")
}
}
dr <- weatherDownload("276120-99999-2013.gz", 2013)
dr
dr <- weatherDownload("276120-99999-2012.gz", 2012)
dr
weatherDownload <- function(filename, year, ftp = ftpLoc) {
destFile <- paste("data/raw/", filename, sep = "")
urlFile <- paste(ftpLoc, year, "/", filename, sep = "")
if(!file.exists(destFile)) {
tryCatch({
download.file(url = urlFile, destfile = destFile)
cat("<download>",urlFile,destFile,"</download>",sep=",")
return("<download successful>")
},
warning = function(e) {return(e)},
error = function(e) {unlink(destFile)
return(e)})
} else {
return("<file already downloaded>")
}
}
dr <- weatherDownload("276120-99999-2012.gz", 2012)
dr
dr <- weatherDownload("276120-99999-2011.gz", 2011)
dr
r <- getWeather(di, s, e)
r
getWeather <- function(stations, sDate, eDate) {
begin <- year(sDate)
end <- year(eDate)
years <- abs(end-begin)
outputs <- as.data.frame(matrix(NA, dim(stations)[1]*years,3))
names(outputs) <- c("FILE","YEAR","STATUS")
for (y in begin:end) {
y.stations <- stations[stations$BEGIN <= y & stations$END >=
y, ]
for (s in 1:dim(y.stations)[1]) {
outputs[s, 1] <- paste(sprintf("%06d", y.stations[s,1]),
"-",
sprintf("%05d", y.stations[s,2]),
"-",
y,
".gz",
sep = "")
outputs[s, 2] <- y
#Download files
outputs[s, 3] <- weatherDownload(outputs[s,1], y)
}
}
outputs
}
r <- getWeather(di, s, e)
r
getWeather <- function(stations, sDate, eDate) {
begin <- year(sDate)
end <- year(eDate)
years <- abs(end-begin)
outputs <- as.data.frame(matrix(NA, dim(stations)[1]*years,3))
names(outputs) <- c("FILE","YEAR","STATUS")
for (y in begin:end) {
y.stations <- stations[stations$BEGIN <= y & stations$END >=
y, ]
for (s in 1:dim(y.stations)[1]) {
outputs[s, 1] <- paste(sprintf("%06d", y.stations[s,1]),
"-",
sprintf("%05d", y.stations[s,2]),
"-",
y,
".gz",
sep = "")
outputs[s, 2] <- y
#Download files
outputs[s, 3] <- weatherDownload(outputs[s,1], y)
cat("<record>",s,outputs[s,1],outputs[s,2],outputs[s,3],
"</record",sep=",")
}
}
outputs
}
r <- getWeather(di, s, e)
getWeather <- function(stations, sDate, eDate) {
begin <- year(sDate)
end <- year(eDate)
years <- abs(end-begin)
outputs <- as.data.frame(matrix(NA, dim(stations)[1]*years,3))
names(outputs) <- c("FILE","YEAR","STATUS")
for (y in begin:end) {
y.stations <- stations[stations$BEGIN <= y & stations$END >=
y, ]
cat("Stations","dim(y.stations)[1]",sep=":")
for (s in 1:dim(y.stations)[1]) {
outputs[s, 1] <- paste(sprintf("%06d", y.stations[s,1]),
"-",
sprintf("%05d", y.stations[s,2]),
"-",
y,
".gz",
sep = "")
outputs[s, 2] <- y
#Download files
outputs[s, 3] <- weatherDownload(outputs[s,1], y)
cat("<record>",s,outputs[s,1],outputs[s,2],outputs[s,3],
"</record",sep=",")
}
}
outputs
}
r <- getWeather(di, s, e)
getWeather <- function(stations, sDate, eDate) {
begin <- year(sDate)
end <- year(eDate)
years <- abs(end-begin)
outputs <- as.data.frame(matrix(NA, dim(stations)[1]*years,3))
names(outputs) <- c("FILE","YEAR","STATUS")
for (y in begin:end) {
y.stations <- stations[stations$BEGIN <= y & stations$END >=
y, ]
cat("Stations",dim(y.stations)[1],sep=":")
for (s in 1:dim(y.stations)[1]) {
outputs[s, 1] <- paste(sprintf("%06d", y.stations[s,1]),
"-",
sprintf("%05d", y.stations[s,2]),
"-",
y,
".gz",
sep = "")
outputs[s, 2] <- y
#Download files
outputs[s, 3] <- weatherDownload(outputs[s,1], y)
cat("<record>",s,outputs[s,1],outputs[s,2],outputs[s,3],
"</record",sep=",")
}
}
outputs
}
r <- getWeather(di, s, e)
getWeather <- function(stations, sDate, eDate) {
begin <- year(sDate)
end <- year(eDate)
years <- abs(end-begin)
outputs <- as.data.frame(matrix(NA, dim(stations)[1]*years,3))
names(outputs) <- c("FILE","YEAR","STATUS")
for (y in begin:end) {
y.stations <- stations[stations$BEGIN <= y & stations$END >=
y, ]
cat("Stations",dim(outputs)[1],sep=":")
for (s in 1:dim(outputs)[1]) {
outputs[s, 1] <- paste(sprintf("%06d", y.stations[s,1]),
"-",
sprintf("%05d", y.stations[s,2]),
"-",
y,
".gz",
sep = "")
outputs[s, 2] <- y
#Download files
outputs[s, 3] <- weatherDownload(outputs[s,1], y)
cat("<record>",s,outputs[s,1],outputs[s,2],outputs[s,3],
"</record",sep=",")
}
}
outputs
}
r <- getWeather(di, s, e)
r
cl
di
outputs <- as.data.frame(matrix(NA, dim(di)[1]*5,3))
names(outputs) <- c("FILE","YEAR","STATUS")
outputs
di
y.di <- di[di$BEGIN <= y & di$END >=
y, ]
getWeather <- function(stations, sDate, eDate) {
begin <- year(sDate)
end <- year(eDate)
years <- abs(end-begin)
outputs <- as.data.frame(matrix(NA, dim(stations)[1]*years,3))
names(outputs) <- c("FILE","YEAR","STATUS")
i <- 1
for (y in begin:end) {
y.stations <- stations[stations$BEGIN <= y & stations$END >=
y, ]
cat("Stations",dim(outputs)[1],sep=":")
for (s in 1:dim(y.stations)[1]) {
outputs[i, 1] <- paste(sprintf("%06d", y.stations[s,1]),
"-",
sprintf("%05d", y.stations[s,2]),
"-",
y,
".gz",
sep = "")
outputs[i, 2] <- y
#Download files
outputs[i, 3] <- weatherDownload(outputs[s,1], y)
cat("<record>",s,outputs[s,1],outputs[s,2],outputs[s,3],
"</record",sep=",")
i = i + 1
}
}
outputs
}
r <- getWeather(di, s, e)
r
shiny::runApp('EnergyForecaster')
